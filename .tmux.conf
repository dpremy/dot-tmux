# some options below are tmux version specific
# while we could detect version and apply only the options
# which are supported, using set with quiet '-q' is easier

# ---------------------
# utf8 for tmux < 2.2
# ---------------------
set -gq utf8                                                # set utf8 global
setw -gq utf8 on                                            # set utf8 for each window

# ---------------------
# terminal options
# ---------------------
set -gs default-terminal "screen-256color"                  # default terminal for new windows created in sessions
#set -g terminal-overrides 'xterm*:putty*:colors=256:smcup@:rmcup@'

# environment variables to be copied into the session environment when a new session
# is created or an existing session is attached includes TERM variable of terminal emulator
set -g update-environment 'DISPLAY SSH_ASKPASS SSH_AUTH_SOCK SSH_AGENT_PID SSH_CONNECTION WINDOWID XAUTHORITY TERM'

set -g status-keys vi                                       # tmux should check the editor for vi, but set it manually either way

set -g focus-events on                                      # focus events enabled for terminals that support them


# ---------------------
# prefix and bind options
# ---------------------
unbind C-b                                                  # unbind C-b to free it up
set -g prefix `                                             # set ` (tic) as the default prefix key combination

bind ` send-prefix                                          # use send-prefix to pass ` (tic) through to application

set -sg escape-time 1                                       # shorten command delay

set -g base-index 1                                         # base index to 1 for quicker main window access (default 0)
setw -g pane-base-index 1                                   # base index to 1 (default 0)
setw -g automatic-rename on                                 # attempt to rename windows based on command currently running
set -g renumber-windows on                                  # when a window is closed in a session, automatically renumber the other windows in numerical order

bind    F               swap-window -t 1                    # prefix F to make the current window the first window
bind    r  source-file ~/.tmux.conf \; display "Reloaded!"  # prefix r reloads ~/.tmux.conf
bind    |               split-window -h                     # prefix | to split window horizontally
bind    -               split-window -v                     # prefix - to split vertically
bind -r "<"             swap-window -t -1                   # prefix < to move the window one position to the left
bind -r ">"             swap-window -t +1                   # prefix > to move the window one position to the right
bind -r M-p             previous-window                     # prefix p selects next window
bind -r M-n             next-window                         # prefix n selects previous window
bind -r Up              select-pane -U                      # prefix arrow key select panes
bind -r Down            select-pane -D                      # prefix arrow key select panes
bind -r Left            select-pane -L                      # prefix arrow key select panes
bind -r Right           select-pane -R                      # prefix arrow key select panes
bind -r M-Up            resize-pane -U 5                    # prefix shift arrows adjust pane size by 5
bind -r M-Down          resize-pane -D 5                    # prefix shift arrows adjust pane size by 5
bind -r M-Left          resize-pane -L 5                    # prefix shift arrows adjust pane size by 5
bind -r M-Right         resize-pane -R 5                    # prefix shift arrows adjust pane size by 5
bind -r C-Up            resize-pane -U                      # prefix ctrl arrows adjust pane size by 1
bind -r C-Down          resize-pane -D                      # prefix ctrl arrows adjust pane size by 1
bind -r C-Left          resize-pane -L                      # prefix ctrl arrows adjust pane size by 1
bind -r C-Right         resize-pane -R                      # prefix ctrl arrows adjust pane size by 1
bind    v               select-layout even-vertical         # prefix v for even-vertical arrangement
bind    h               select-layout even-horizontal       # prefix h for even-horizontal arrangement
bind    C-s             set-window-option synchronize-panes # prefix ctrl s to synchronize all panes input

# ---------------------
# mouse control for tmux < 2.1
# ---------------------
set -gq mouse on                                            # turn on mouse for tmux > 2.1
setw -gq mode-mouse on                                      # turn on mouse for tmux < 2.1
set -gq mouse-select-pane off                               # disable mouse from changing panes for tmux < 2.1
set -gq mouse-resize-pane on                                # allow panes to be re-sized by dragging borders for tmux < 2.1
set -gq mouse-select-window on                              # allow mouse to change windows using window name in status line for tmux < 2.1

# ---------------------
# copy and paste
# ---------------------
setw -g mode-keys vi                                        # use vim keybindings in copy mode

# ----------------------
# colors
# ----------------------
# set pane colors - hilight the active pane
set -g pane-border-fg colour235
set -g pane-active-border-fg colour33

# colorize messages in the command line
set -g message-bg black
set -g message-fg brightred

# ----------------------
# status bar
# -----------------------
set -g status on                                            # turn the status bar on
set -gq status-utf8 on                                      # set utf-8 for the status bar, required for tmux < 2.2
set -g status-interval 10                                   # set update frequency (default 15 seconds)
set -g status-justify centre                                # center window list for clarity

setw -g monitor-activity on                                 # enable monitoring of activity in windows
set -g visual-activity on                                   # display status line message of activity in other windows

# set color for status bar
set -g status-bg colour235
set -g status-fg yellow
set -g status-attr dim

# set window list colors - red for active and cyan for inactive
setw -g window-status-fg brightblue
setw -g window-status-bg colour236
setw -g window-status-attr dim

setw -g window-status-current-fg brightred
setw -g window-status-current-bg colour236
setw -g window-status-current-attr bright

# set statusbar left length
set -g status-left-length 85

# show cpu (plugin), pane title, session name, window & pane number, date and time on right side of status bar
set -g status-right-length 80
set -g status-right "#{cpu_percentage} : #[fg=cyan]#{=15:pane_title} : #[fg=blue]#S #I:#P #[fg=yellow]: %d %b %Y #[fg=green]: %l:%M %p"

set -g display-time 4000                                    # set tmux messages to be shown for 4 seconds

setw -g aggressive-resize on                                # if using a grouped session or multi-monitor setup turn on the aggressive re-sizing for panes

set -g history-limit 30000                                  # set scrollback history to 30000 (30k)

# -----------------------
# tmux plugins
# -----------------------
# list of plugins (use prefix + I to install, prefix + U to update)
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-sessionist'
set -g @plugin 'seebi/tmux-colors-solarized'

# initialize tpm (keep this line at the very bottom of tmux.conf)
if "test ! -d ~/.tmux/plugins/tpm" \
  "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm'"

if "test ! -d ~/.tmux/plugins/tmux-cpu" \
  "run 'git clone https://github.com/tmux-plugins/tmux-cpu ~/.tmux/plugins/tmux-cpu'"

if "test ! -d ~/.tmux/plugins/tmux-sessionist" \
  "run 'git clone https://github.com/tmux-plugins/tmux-sessionist ~/.tmux/plugins/tmux-sessionist'"

if "test ! -d ~/.tmux/plugins/tmux-colors-solarized" \
  "run 'git clone https://github.com/seebi/tmux-colors-solarized ~/.tmux/plugins/tmux-colors-solarized'"

run '~/.tmux/plugins/tpm/tpm'
